generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            String   @id @default(uuid())
  email         String   @unique
  password      String
  name          String
  company       String?
  plan          Plan     @default(STARTER)
  role          UserRole @default(USER)
  isActive      Boolean  @default(true)
  twoFactorEnabled Boolean @default(false)
  twoFactorSecret String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  wallets       Wallet[]
  alerts        Alert[]
  reports       Report[]
  apiKeys       ApiKey[]
  paymentSettings PaymentSettings?
}

model Wallet {
  id            String   @id @default(uuid())
  address       String   @unique
  blockchain    Blockchain
  label         String?
  userId        String
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  isMonitored   Boolean  @default(true)
  riskScore     Float    @default(0)
  riskLevel     RiskLevel @default(LOW)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  transactions  Transaction[]
  alerts        Alert[]
}

model Transaction {
  id            String   @id @default(uuid())
  hash          String   @unique
  walletId      String
  wallet        Wallet   @relation(fields: [walletId], references: [id], onDelete: Cascade)
  blockchain    Blockchain
  fromAddress   String
  toAddress     String
  amount        Float
  timestamp     DateTime
  riskScore     Float
  riskLevel     RiskLevel
  flags         String[]
  analyzed      Boolean  @default(false)
  createdAt     DateTime @default(now())
  
  alerts        Alert[]
}

model Alert {
  id            String   @id @default(uuid())
  userId        String
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  walletId      String?
  wallet        Wallet?  @relation(fields: [walletId], references: [id], onDelete: Cascade)
  transactionId String?
  transaction   Transaction? @relation(fields: [transactionId], references: [id], onDelete: Cascade)
  type          AlertType
  severity      RiskLevel
  title         String
  description   String
  isRead        Boolean  @default(false)
  isResolved    Boolean  @default(false)
  createdAt     DateTime @default(now())
}

model Report {
  id            String   @id @default(uuid())
  userId        String
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  type          ReportType
  format        ReportFormat
  startDate     DateTime
  endDate       DateTime
  fileUrl       String?
  status        ReportStatus @default(PENDING)
  createdAt     DateTime @default(now())
}

model ApiKey {
  id            String   @id @default(uuid())
  userId        String
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  key           String   @unique
  name          String
  isActive      Boolean  @default(true)
  lastUsed      DateTime?
  createdAt     DateTime @default(now())
}

model PaymentSettings {
  id            String   @id @default(uuid())
  userId        String   @unique
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  config        String
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
}

enum Plan {
  STARTER
  GROWTH
  ENTERPRISE
}

enum Blockchain {
  BITCOIN
  ETHEREUM
  SOLANA
  CARDANO
  POLKADOT
  AVALANCHE
  COSMOS
  ALGORAND
  TEZOS
  NEAR
  APTOS
  SUI
  HEDERA
  TRON
  RIPPLE
  STELLAR
  LITECOIN
  MONERO
  ZCASH
  DASH
  ETHEREUM_CLASSIC
  FANTOM
  CELO
  CHAINLINK
  FILECOIN
  VET
  THETA
  ELROND
  FLOW
  HARMONY
  ZILLIQA
  WAVES
  ICON
  ONTOLOGY
  QTUM
  KLAYTN
  OASIS
  IOTA
  NEO
  EOS
  KUSAMA
  ASTAR
  MOONRIVER
  MOONBEAM
  ACALA
  KARURA
  PARALLEL
  BIFROST
  PHALA
  CENTRIFUGE
  INTERLAY
  KINTSUGI
  KAVA
  BAND
  INJECTIVE
  OSMOSIS
  JUNO
  STARGAZE
  AKASH
  SECRET
  TERRA
  KUJIRA
  EVMOS
  AXELAR
  CELESTIA
  SEI
  NEUTRON
  DYDX
  STRIDE
  COMDEX
  CRESCENT
  UMEE
  SOMMELIER
  QUICKSILVER
  PERSISTENCE
  REGEN
  SENTINEL
  CHIHUAHUA
  BITCANNA
  DESMOS
  LIKECOIN
  IRIS
  EMONEY
  SIFCHAIN
  KONSTELLATION
  RIZON
  PROVENANCE
  CHEQD
  ASSETMANTLE
  FETCHAI
  KI
  MEDIBLOC
  BITSONG
  LUMENX
  VIDULUM
  DECENTR
  CERBERUS
  OMNIFLIX
  PASSAGE
  TERITORI
  ARCHWAY
  JACKAL
  MIGALOO
  NOLUS
  QUASAR
  COMPOSABLE
  POLYGON
  ARBITRUM
  OPTIMISM
  BASE
  ZKSYNC
  STARKNET
  SCROLL
  LINEA
  MANTA
  BLAST
  IMMUTABLE
  METIS
  BOBA
  LOOPRING
  AZTEC
  POLYGON_ZKEVM
  TAIKO
  MODE
  ZORA
  MANTLE
  CANTO
  KROMA
  OPBNB
  ZKFAIR
  AEVO
  LYRA
  ANCIENT8
  PARADEX
  REDDIO
  HYPR
  MINT
  XTERIO
  REDSTONE
  APEX
  MYRIA
  DEBANK
  FRAME
  CYBER
  HAM
  BNB_CHAIN
  CRONOS
  RONIN
  AURORA
  GNOSIS
  FUSE
  EVMOS_EVM
  KAVA_EVM
  CANTO_EVM
  METER
  SYSCOIN
  VELAS
  WANCHAIN
  THUNDERCORE
  TOMOCHAIN
  HECO
  OKXCHAIN
  KUCOIN
  BITGERT
  CORE
  CONFLUX
  AION
  ENERGI
  GOCHAIN
  ELASTOS
  NULS
  ARDOR
  STRATIS
  ARK
  LISK
  NEM
  SYMBOL
  KOMODO
  PIVX
  NAVCOIN
  VERGE
  HORIZEN
  BEAM
  GRIN
  DECRED
  DIGIBYTE
  RAVENCOIN
  VERTCOIN
  ERGO
  NERVOS
  KADENA
  FLUX
  ALEPHIUM
  KASPA
  ALEO
  IMMUTABLE_ZKEVM
  GALA
  ENJIN
  EFINITY
  WAX
  ULTRA
  IOTEX
  SANDBOX
  DECENTRALAND
  AXIE
  ILLUVIUM
  GODS
  STAR_ATLAS
  BIGTIME
  TREASURE
  BEAM_GAMING
  XPLA
  OASYS
  HOME_VERSE
  MCH_VERSE
  DEFI_KINGDOMS
  SWIMMER
  SHRAPNEL
  GUNZILLA
  GALA_FILM
  GALA_MUSIC
  VULCAN
  MOBOX
  ALTURA
  SIDUS
  THORCHAIN
  MAYA
  PENDLE
  RADIX
  FLARE
  SONGBIRD
  XDC
  VITE
  REEF
  ACALA_EVM
  KARURA_EVM
  ASTAR_EVM
  SHIDEN
  CLOVER
  EQUILIBRIUM
  GENSHIRO
  CALAMARI
  MANTA_ATLANTIC
  NODLE
  ZEITGEIST
  BASILISK
  HYDRADX
  PICASSO
  COMPOSABLE_COSMOS
  TURING
  MANGATA
  HEIKO
  ALTAIR
  KHALA
  KINTSUGI_BTC
  BERACHAIN
  MONAD
  FUEL
  ECLIPSE
  MOVEMENT
  ARTELA
  INITIA
  BABYLON
  AVAIL
  ESPRESSO
  EIGENLAYER
  ETHOS
  LUMIA
  MORPH
  ABSTRACT
  STORY
  PLUME
  SONEIUM
  UNICHAIN
  WORLDCHAIN
  LENS
  FARCASTER
  FRIEND_TECH
  DEGEN
  XION
  BEVM
  BITLAYER
  MERLIN
  BOB
  BSQUARED
  ROOTSTOCK
  LIQUID
  STACKS
  FRACTAL
  CITREA
  BOTANIX
  ROLLUX
  NEON
  ECLIPSE_MAINNET
  NITRO
  NOVA
}

enum RiskLevel {
  LOW
  MEDIUM
  HIGH
  CRITICAL
}

enum AlertType {
  HIGH_RISK_TRANSACTION
  SUSPICIOUS_PATTERN
  MIXER_DETECTED
  BLACKLISTED_ADDRESS
  UNUSUAL_VOLUME
  RAPID_MOVEMENT
}

enum ReportType {
  DAILY
  WEEKLY
  MONTHLY
  CUSTOM
}

enum ReportFormat {
  PDF
  CSV
  JSON
}

enum ReportStatus {
  PENDING
  PROCESSING
  COMPLETED
  FAILED
}

enum UserRole {
  USER
  ADMIN
}
